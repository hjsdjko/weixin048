"use strict";(self["webpackChunkvue3_nb0"]=self["webpackChunkvue3_nb0"]||[]).push([[485],{92485:(e,l,n)=>{n.r(l),n.d(l,{default:()=>H});n(39524),n(30721),n(16158),n(63134),n(33510),n(41808),n(87547),n(8971),n(43448),n(86696),n(40073),n(1680),n(30826),n(3299),n(56505),n(98218),n(68838),n(36507);var a=n(67377),u=n(98479),t=(n(31250),n(51290)),o=n(86754),r=n(54432),i=(n(31818),n(51284),n(75014),n(52443),{class:"formModel_btn_box"});const s={__name:"formModel",emits:["formModelChange"],setup:function(e,l){var n,u=l.expose,o=l.emit,r=null===(n=(0,a.FN)())||void 0===n?void 0:n.appContext.config.globalProperties,s="users",d="管理员",c=(0,t.iH)({}),v=(0,t.iH)({username:!1,password:!1,role:!1}),f=(0,t.iH)(!1),p=(0,t.iH)(!1),m=(0,t.iH)(""),g=(0,t.iH)({username:[{required:!0,message:"请输入",trigger:"blur"}],password:[{required:!0,message:"请输入",trigger:"blur"}],role:[]}),h=(0,t.iH)(null),w=(0,t.iH)(0),_=(0,t.iH)(""),b=function(){c.value={username:"",password:"",role:"管理员"}},k=function(){null===r||void 0===r||r.$http({url:"".concat(s,"/info/").concat(w.value),method:"get"}).then((function(e){new RegExp("../../../file","g");c.value=e.data.data,f.value=!0}))},y=(0,t.iH)(""),W=(0,t.iH)(""),C=(0,t.iH)(""),H=(0,t.iH)(""),U=(0,t.iH)(""),x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"add",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,t=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,r=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;if(b(),e&&(w.value=e,_.value=l),"add"==l)p.value=!0,m.value="新增"+d,f.value=!0;else if("info"==l)p.value=!1,m.value="查看"+d,k();else if("edit"==l)p.value=!0,m.value="修改"+d,k();else if("cross"==l){for(var i in p.value=!0,m.value=n,a)"username"!=i?"password"!=i?"role"!=i||(c.value.role=a[i],v.value.role=!0):(c.value.password=a[i],v.value.password=!0):(c.value.username=a[i],v.value.username=!0);a&&(y.value=a),u&&(W.value=u),o&&(C.value=o),t&&(H.value=t),r&&(U.value=r),c.value.role="管理员",f.value=!0}};u({init:x});var V=function(){f.value=!1},$=function(){W.value;var e=JSON.parse(JSON.stringify(y.value)),l="",n="",a="";if("cross"==_.value&&""!=H.value)if(H.value.startsWith("["))l=null===r||void 0===r?void 0:r.$toolUtil.storageGet("userid"),n=e["id"],a=H.value.replace(/\[/,"").replace(/\]/,"");else{for(var u in e)u==H.value&&(e[u]=U.value);z(e)}h.value.validate((function(e){if(e)if(l&&n){c.value.crossuserid=l,c.value.crossrefid=n;var u={page:1,limit:1e3,crossuserid:c.value.crossuserid,crossrefid:c.value.crossrefid};null===r||void 0===r||r.$http({url:"".concat(s,"/page"),method:"get",params:u}).then((function(e){if(e.data.data.total>=a)return null===r||void 0===r||r.$toolUtil.message("".concat(C.value),"error"),!1;null===r||void 0===r||r.$http({url:"".concat(s,"/").concat(c.value.id?"update":"save"),method:"post",data:c.value}).then((function(e){null===r||void 0===r||r.$toolUtil.message("操作成功","success",(function(){f.value=!1,o("formModelChange")}))}))}))}else null===r||void 0===r||r.$http({url:"".concat(s,"/").concat(c.value.id?"update":"save"),method:"post",data:c.value}).then((function(e){null===r||void 0===r||r.$toolUtil.message("操作成功","success",(function(){f.value=!1,o("formModelChange")}))}))}))},z=function(e){null===r||void 0===r||r.$http({url:"".concat(W.value,"/update"),method:"post",data:e}).then((function(e){}))};return function(e,l){var n=(0,a.up)("el-input"),u=(0,a.up)("el-form-item"),t=(0,a.up)("el-col"),o=(0,a.up)("el-row"),r=(0,a.up)("el-form"),s=(0,a.up)("el-button"),d=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(d,{modelValue:f.value,"onUpdate:modelValue":l[3]||(l[3]=function(e){return f.value=e}),title:m.value,width:"80%","destroy-on-close":"",fullscreen:!1},(0,a.Nv)({default:(0,a.w5)((function(){return[(0,a.Wm)(r,{class:"formModel_form",ref_key:"formRef",ref:h,model:c.value,"label-width":"$template2.back.add.form.base.labelWidth",rules:g.value},{default:(0,a.w5)((function(){return[(0,a.Wm)(o,null,{default:(0,a.w5)((function(){return[(0,a.Wm)(t,{span:24},{default:(0,a.w5)((function(){return[(0,a.Wm)(u,{label:"用户名",prop:"username"},{default:(0,a.w5)((function(){return[(0,a.Wm)(n,{class:"list_inp",modelValue:c.value.username,"onUpdate:modelValue":l[0]||(l[0]=function(e){return c.value.username=e}),placeholder:"用户名",type:"text",readonly:!(p.value&&!v.value.username)},null,8,["modelValue","readonly"])]})),_:1})]})),_:1}),(0,a.Wm)(t,{span:24},{default:(0,a.w5)((function(){return[(0,a.Wm)(u,{label:"密码",prop:"password"},{default:(0,a.w5)((function(){return[(0,a.Wm)(n,{class:"list_inp",modelValue:c.value.password,"onUpdate:modelValue":l[1]||(l[1]=function(e){return c.value.password=e}),placeholder:"密码",type:"password",readonly:!(p.value&&!v.value.password)},null,8,["modelValue","readonly"])]})),_:1})]})),_:1}),(0,a.Wm)(t,{span:24},{default:(0,a.w5)((function(){return[(0,a.Wm)(u,{label:"角色",prop:"role"},{default:(0,a.w5)((function(){return[(0,a.Wm)(n,{class:"list_inp",modelValue:c.value.role,"onUpdate:modelValue":l[2]||(l[2]=function(e){return c.value.role=e}),placeholder:"角色",type:"text",readonly:!(p.value&&!v.value.role)},null,8,["modelValue","readonly"])]})),_:1})]})),_:1})]})),_:1})]})),_:1},8,["model","rules"])]})),_:2},[p.value||"logistics"==_.value||"reply"==_.value?{name:"footer",fn:(0,a.w5)((function(){return[(0,a._)("span",i,[(0,a.Wm)(s,{class:"formModel_cancel",onClick:V},{default:(0,a.w5)((function(){return[(0,a.Uk)("取消")]})),_:1}),(0,a.Wm)(s,{class:"formModel_confirm",type:"primary",onClick:$},{default:(0,a.w5)((function(){return[(0,a.Uk)(" 提交 ")]})),_:1})])]})),key:"0"}:void 0]),1032,["modelValue","title"])])}}};var d=n(57326);const c=(0,d.Z)(s,[["__scopeId","data-v-0da03a76"]]),v=c;var f=function(e){return(0,a.dD)("data-v-6c86de90"),e=e(),(0,a.Cn)(),e},p={class:"app-contain"},m={class:"list_search_view"},g={class:"search_view"},h=f((function(){return(0,a._)("div",{class:"search_label"}," 用户名： ",-1)})),w={class:"search_box"},_={class:"search_btn_view"},b=f((function(){return(0,a._)("br",null,null,-1)})),k={class:"btn_view"},y=f((function(){return(0,a._)("br",null,null,-1)}));const W={__name:"list",setup:function(e){var l,n=null===(l=(0,a.FN)())||void 0===l?void 0:l.appContext.config.globalProperties,i="users",s="管理员";(0,o.yj)();(0,a.bv)((function(){}));var d=(0,t.iH)(null),c=(0,t.iH)(null),f=(0,t.iH)({page:1,limit:20,sort:"id",order:"desc"}),W=(0,t.iH)({}),C=(0,t.iH)([]),H=(0,t.iH)(!1),U=function(e){(0,a.Y3)((function(){c.value.clearSelection(),c.value.toggleRowSelection(e)}))},x=function(){H.value=!0;var e=JSON.parse(JSON.stringify(f.value));e["sort"]="id",e["order"]="desc",W.value.username&&""!=W.value.username&&(e["username"]="%"+W.value.username+"%"),null===n||void 0===n||n.$http({url:"".concat(i,"/page"),method:"get",params:e}).then((function(e){H.value=!1,d.value=e.data.data.list,z.value=Number(e.data.data.total)}))},V=function(e){var l=(0,t.iH)([]);if(e)l.value=[e];else{if(!C.value.length)return!1;for(var a in C.value)l.value.push(C.value[a].id)}r.T.confirm("是否删除选中".concat(s),"提示",{confirmButtonText:"是",cancelButtonText:"否",type:"warning"}).then((function(){null===n||void 0===n||n.$http({url:"".concat(i,"/delete"),method:"post",data:l.value}).then((function(e){null===n||void 0===n||n.$toolUtil.message("删除成功","success",(function(){x()}))}))}))},$=function(e){C.value=e},z=(0,t.iH)(0),j=(0,t.iH)(["total","prev","pager","next","jumper"]),M=function(e){f.value.limit=e,x()},N=function(e){f.value.page=e,x()},S=function(){f.value.page=f.value.page-1,x()},q=function(){f.value.page=f.value.page+1,x()},R=function(e,l){return null===n||void 0===n?void 0:n.$toolUtil.isAuth(e,l)},J=function(){f.value.page=1,x()},O=(0,t.iH)(null),D=function(){J()},F=function(){O.value.init()},P=function(){C.value.length&&O.value.init(C.value[0].id,"edit")},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?O.value.init(e,"info"):C.value.length&&O.value.init(C.value[0].id,"info")},A=function(){x()};return A(),function(e,l){var n=(0,a.up)("el-input"),t=(0,a.up)("el-button"),o=(0,a.up)("el-form"),r=(0,a.up)("el-table-column"),i=(0,a.up)("el-table"),s=(0,a.up)("el-pagination"),x=(0,a.Q2)("loading");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("div",p,[(0,a._)("div",m,[(0,a.Wm)(o,{model:W.value,class:"search_form"},{default:(0,a.w5)((function(){return[(0,a._)("div",g,[h,(0,a._)("div",w,[(0,a.Wm)(n,{class:"search_inp",modelValue:W.value.username,"onUpdate:modelValue":l[0]||(l[0]=function(e){return W.value.username=e}),placeholder:"用户名",clearable:""},null,8,["modelValue"])])]),(0,a._)("div",_,[(0,a.Wm)(t,{class:"search_btn",type:"primary",onClick:l[1]||(l[1]=function(e){return J()}),size:"small"},{default:(0,a.w5)((function(){return[(0,a.Uk)("搜索")]})),_:1})])]})),_:1},8,["model"]),b,(0,a._)("div",k,[R("users","新增")?((0,a.wg)(),(0,a.j4)(t,{key:0,type:"success",onClick:F},{default:(0,a.w5)((function(){return[(0,a.Uk)("新增")]})),_:1})):(0,a.kq)("",!0),R("users","查看")?((0,a.wg)(),(0,a.j4)(t,{key:1,type:"info",disabled:1!=C.value.length,onClick:l[2]||(l[2]=function(e){return T(null)})},{default:(0,a.w5)((function(){return[(0,a.Uk)("详情")]})),_:1},8,["disabled"])):(0,a.kq)("",!0),R("users","修改")?((0,a.wg)(),(0,a.j4)(t,{key:2,type:"primary",disabled:1!=C.value.length,onClick:P},{default:(0,a.w5)((function(){return[(0,a.Uk)("修改")]})),_:1},8,["disabled"])):(0,a.kq)("",!0),R("users","删除")?((0,a.wg)(),(0,a.j4)(t,{key:3,type:"danger",disabled:!C.value.length,onClick:l[3]||(l[3]=function(e){return V(null)})},{default:(0,a.w5)((function(){return[(0,a.Uk)("删除")]})),_:1},8,["disabled"])):(0,a.kq)("",!0)])]),y,R("users","查看")?(0,a.wy)(((0,a.wg)(),(0,a.j4)(i,{key:0,border:"",stripe:!0,onSelectionChange:$,ref_key:"table",ref:c,data:d.value,onRowClick:U},{default:(0,a.w5)((function(){return[(0,a.Wm)(r,{resizable:!0,align:"left","header-align":"center",type:"selection",width:"55"}),(0,a.Wm)(r,{label:"序号",width:"70",resizable:!0,sortable:!0,align:"left","header-align":"center"},{default:(0,a.w5)((function(e){return[(0,a.Uk)((0,u.zw)(e.$index+1),1)]})),_:1}),(0,a.Wm)(r,{resizable:!0,sortable:!0,align:"left","header-align":"center",label:"用户名"},{default:(0,a.w5)((function(e){return[(0,a.Uk)((0,u.zw)(e.row.username),1)]})),_:1}),(0,a.Wm)(r,{resizable:!0,sortable:!0,align:"left","header-align":"center",label:"角色"},{default:(0,a.w5)((function(e){return[(0,a.Uk)((0,u.zw)(e.row.role),1)]})),_:1}),(0,a.Wm)(r,{label:"操作",width:"300",resizable:!0,sortable:!0,align:"left","header-align":"center"},{default:(0,a.w5)((function(e){return[R("users","查看")?((0,a.wg)(),(0,a.j4)(t,{key:0,type:"info",onClick:function(l){return T(e.row.id)}},{default:(0,a.w5)((function(){return[(0,a.Uk)("详情")]})),_:2},1032,["onClick"])):(0,a.kq)("",!0)]})),_:1})]})),_:1},8,["data"])),[[x,H.value]]):(0,a.kq)("",!0),(0,a.Wm)(s,{background:"",layout:j.value.join(","),total:z.value,"page-size":f.value.limit,"prev-text":"<","next-text":">","hide-on-single-page":!0,style:{padding:"0",margin:"20px 0 0",whiteSpace:"nowrap",color:"#333",textAlign:"center",width:"100%",fontWeight:"500"},onSizeChange:M,onCurrentChange:N,onPrevClick:S,onNextClick:q},null,8,["layout","total","page-size"])]),(0,a.Wm)(v,{ref_key:"formRef",ref:O,onFormModelChange:D},null,512)])}}},C=(0,d.Z)(W,[["__scopeId","data-v-6c86de90"]]),H=C}}]);
//# sourceMappingURL=485.45e05143.js.map